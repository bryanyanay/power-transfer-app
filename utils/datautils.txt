import { PrismaClient } from '@prisma/client';
import { UserProfile, useUser } from '@auth0/nextjs-auth0';

const p = new PrismaClient();

export async function getUserID(email: string) {
  const user = await p.user.findUnique({
    where: {
      email: email
    }
  });
  if (!user) {
    throw 'User not found!';
  } 
  return user.id;
}

export async function getVehicles(email: string) {
  const vehicles = await p.user.findUnique({
    where: {
      email: email
    },
    select: {
      vehicles: true
    }
  });
  if (!vehicles) return []; // they have no vehicles
  return vehicles.vehicles;
}

export async function addVehicle(license: string, email: string) {
  await p.vehicle.create({
    data: {
      license: license,
      owner: {
        connect: {
          email: email
        }
      }
    }
  })
}